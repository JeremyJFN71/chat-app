"use strict";(self.webpackChunkchat_app=self.webpackChunkchat_app||[]).push([[808],{101:function(e,t,s){s.r(t),s.d(t,{default:function(){return m}});var n=s(142);function r(e,t,s){return(t=(0,n.Z)(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function a(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function c(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?a(Object(s),!0).forEach((function(t){r(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):a(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var i=s(433),l=s(439),o=s(243),d=s(791),u=s(689),f=s.p+"static/media/default-avatar.32fc2969ed2bea3cf295.png";var p=s.p+"static/media/send.ba6d16bce2708c5eddfc513238b9b255.svg",h=s(184),m=function(){var e=(0,d.useState)(""),t=(0,l.Z)(e,2),s=t[0],n=t[1],r=(0,d.useState)({}),a=(0,l.Z)(r,2),m=a[0],x=a[1],j=(0,d.useState)(),g=(0,l.Z)(j,2),v=g[0],b=g[1],N=(0,d.useState)(""),y=(0,l.Z)(N,2),O=y[0],w=y[1],S=(0,d.useState)([]),k=(0,l.Z)(S,2),P=k[0],Z=k[1],C=(0,u.s0)(),_=(0,d.useRef)(),E=(0,d.useRef)(),D=(0,u.bx)();(0,d.useEffect)((function(){var e=new WebSocket("ws://localhost:3001");n(e);return e.addEventListener("message",(function(e){var t=JSON.parse(e.data);"online"in t?R(t.online):"message"in t&&Z((function(e){return[].concat((0,i.Z)(e),[c({},t.message)])}))})),function(){return e.close()}}),[]),(0,d.useEffect)((function(){var e,t;null===(e=E.current)||void 0===e||e.scrollTo(0,E.current.scrollHeight),null===(t=_.current)||void 0===t||t.focus()}),[P,v]);var R=function(e){var t={};e.forEach((function(e){var s=e.id,n=e.username;t[s]=n})),x(t)},T=function(e){return P.filter((function(t){return t.sender===e||t.sender===D._id&&t.recipient===e}))},F=c({},m);return delete F[D._id],(0,h.jsx)("div",{className:"container-fluid bg-theme-primary rounded-2",children:(0,h.jsxs)("div",{className:"row",children:[(0,h.jsxs)("div",{className:"col-lg-4 col-sm-6 contact p-0",children:[(0,h.jsxs)("div",{className:"header p-3",children:[(0,h.jsx)("img",{src:"/logo512.png",alt:"",height:"40px"}),(0,h.jsx)("h4",{className:"fw-bold",children:"Chat App"})]}),(0,h.jsx)("div",{className:"contact-content",children:Object.keys(F).map((function(e){var t;return(0,h.jsxs)("div",{className:"person-wrapper ".concat(v===e?"active":""),children:[(0,h.jsx)("div",{className:"cool-active"}),(0,h.jsxs)("div",{onClick:function(){return function(e){b(e)}(e)},className:"person",children:[(0,h.jsxs)("div",{className:"person-avatar",children:[(0,h.jsx)("div",{className:"online"}),(0,h.jsx)("img",{src:f,alt:""})]}),(0,h.jsxs)("div",{children:[(0,h.jsx)("span",{children:F[e]}),(0,h.jsxs)("span",{className:"person-chat",children:[T(e)[0]?T(e)[T(e).length-1].sender!==e&&"You: ":"",null===(t=T(e)[T(e).length-1])||void 0===t?void 0:t.text]})]})]})]},e)}))}),(0,h.jsxs)("div",{className:"profile p-3",children:[(0,h.jsxs)("div",{className:"d-flex column-gap-2 align-items-center",children:[(0,h.jsx)("img",{src:f,alt:"",height:"40px"}),(0,h.jsx)("span",{children:D.username}),(0,h.jsx)("sup",{children:(0,h.jsx)("i",{className:"fa-solid fa-pen-to-square"})})]}),(0,h.jsx)("div",{className:"cool-btn",onClick:function(){o.Z.get("/api/auth/logout").then((function(e){s.close(),C("/login")})).catch((function(e){return console.error(e.response)}))},children:(0,h.jsx)("i",{className:"fa-solid fa-right-from-bracket text-danger"})})]})]}),(0,h.jsx)("div",{className:"col-lg-8 col-sm-6 chat p-0",children:v?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("div",{className:"recipient p-3",children:[(0,h.jsx)("img",{src:f,alt:"",height:"40px"}),(0,h.jsx)("span",{children:m[v]})]}),(0,h.jsx)("div",{className:"chat-content",ref:E,children:(0,h.jsx)("div",{className:"my-3",children:T(v).map((function(e,t){return(0,h.jsx)("div",{className:"chat-message",style:e.sender===D._id?{marginLeft:"auto",background:"white"}:{marginRight:"auto"},children:(0,h.jsx)("p",{className:"text-".concat(e.sender===D._id?"black":"white"),children:e.text})},t)}))})}),(0,h.jsx)("div",{className:"input p-3",children:(0,h.jsxs)("form",{method:"POST",onSubmit:function(e){if(e.preventDefault(),O){var t={sender:D._id,recipient:v,text:O};s.send(JSON.stringify(t)),Z((function(e){return[].concat((0,i.Z)(e),[t])})),w("")}},children:[(0,h.jsx)("button",{type:"submit",className:"cool-btn",children:(0,h.jsx)("i",{className:"fa-solid fa-paperclip"})}),(0,h.jsx)("input",{ref:_,className:"input-theme",type:"text",placeholder:"Type your message",value:O,onChange:function(e){return w(e.target.value)},autoComplete:"false"}),(0,h.jsx)("button",{type:"submit",className:"cool-btn",children:(0,h.jsx)("img",{src:p,alt:""})})]})})]}):(0,h.jsx)(h.Fragment,{children:(0,h.jsxs)("div",{className:"d-flex justify-content-center align-items-center flex-column gap-4",style:{height:"100%"},children:[(0,h.jsx)("i",{className:"fa-solid fa-message text-center",style:{fontSize:"100px",color:"gray"}}),(0,h.jsx)("h1",{className:"unselectable",style:{color:"gray"},children:"Start Conversation"})]})})})]})})}}}]);
//# sourceMappingURL=808.5de18556.chunk.js.map